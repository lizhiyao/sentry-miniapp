<!--test.wxml-->
<view class="container">
  <view class="header-section">
    <text class="page-title">功能实验室</text>
    <text class="page-desc">触发不同类型的事件以测试 Sentry 监控能力</text>
  </view>

  <!-- 用户身份卡片 -->
  <view class="card user-card">
    <view class="user-info">
      <view class="avatar-placeholder"
            style="background: {{hasUserInfo ? '#6C5FC7' : '#E2E8F0'}}">
        <text>{{hasUserInfo ? 'U' : '?'}}</text>
      </view>
      <view class="user-meta">
        <text class="user-name">{{hasUserInfo ? userInfo.nickName : '未登录用户'}}</text>
        <text class="user-status">{{hasUserInfo ? 'ID: ' + userInfo.id : '匿名访问'}}</text>
      </view>
    </view>
    <button class="btn-sm {{hasUserInfo ? 'btn-outline-danger' : 'btn-primary'}}"
            bindtap="{{hasUserInfo ? 'clearUserProfile' : 'getUserProfile'}}">
      {{hasUserInfo ? '退出' : '登录'}}
    </button>
  </view>

  <!-- 错误捕获测试 -->
  <view class="section-title">错误捕获</view>
  <view class="card action-list">
    <view class="action-item"
          bindtap="testException">
      <view class="icon-box error">💥</view>
      <view class="action-content">
        <text class="action-name">JS 异常</text>
        <text class="action-desc">触发一个未捕获的 JavaScript 错误</text>
      </view>
      <view class="action-btn">测试</view>
    </view>

    <view class="action-item"
          bindtap="testAsyncError">
      <view class="icon-box warning">⏱️</view>
      <view class="action-content">
        <text class="action-name">异步异常</text>
        <text class="action-desc">在 Promise 或定时器中抛出错误</text>
      </view>
      <view class="action-btn">测试</view>
    </view>

    <view class="action-item"
          bindtap="testMessage">
      <view class="icon-box info">📝</view>
      <view class="action-content">
        <text class="action-name">消息上报</text>
        <text class="action-desc">Sentry.captureMessage()</text>
      </view>
      <view class="action-btn">测试</view>
    </view>
  </view>

  <!-- 性能与网络 -->
  <view class="section-title">性能与网络</view>
  <view class="card action-list">
    <view class="action-item"
          bindtap="testRequest">
      <view class="icon-box success">🌐</view>
      <view class="action-content">
        <text class="action-name">网络请求</text>
        <text class="action-desc">发起一个 XHR 请求并监控耗时</text>
      </view>
      <view class="action-btn">测试</view>
    </view>

    <view class="action-item"
          bindtap="testNetworkPerformance">
      <view class="icon-box success">📊</view>
      <view class="action-content">
        <text class="action-name">网络性能追踪</text>
        <text class="action-desc">生成 Transaction 记录请求性能</text>
      </view>
      <view class="action-btn">测试</view>
    </view>
  </view>

  <!-- 高级功能 -->
  <view class="section-title">高级功能</view>
  <view class="card action-list">
    <view class="action-item"
          bindtap="testUserFeedback">
      <view class="icon-box primary">💬</view>
      <view class="action-content">
        <text class="action-name">用户反馈</text>
        <text class="action-desc">提交带有上下文的用户反馈</text>
      </view>
      <view class="action-btn">测试</view>
    </view>
  </view>

</view>